# Yarn å…¥é—¨

> Yarn æ˜¯å¿«é€Ÿã€å¯é ã€å®‰å…¨çš„ js åŒ…ç®¡ç†å™¨ã€‚
>
> å…³é”®è¯ï¼š `nodejs`, `åŒ…ç®¡ç†`, `yarn`

<!-- TOC depthFrom:2 depthTo:3 -->

- [1. ç®€ä»‹](#1-ç®€ä»‹)
- [2. å®‰è£…](#2-å®‰è£…)
- [3. Yarn å·¥ä½œæµ](#3-yarn-å·¥ä½œæµ)
- [4. Yarn å¸¸ç”¨å‘½ä»¤](#4-yarn-å¸¸ç”¨å‘½ä»¤)
    - [4.1. åˆå§‹åŒ–æ–°é¡¹ç›®](#41-åˆå§‹åŒ–æ–°é¡¹ç›®)
    - [4.2. æ·»åŠ ä¾èµ–åŒ…](#42-æ·»åŠ ä¾èµ–åŒ…)
    - [4.3. æ›´æ–°ä¾èµ–åŒ…](#43-æ›´æ–°ä¾èµ–åŒ…)
    - [4.4. åˆ é™¤ä¾èµ–åŒ…](#44-åˆ é™¤ä¾èµ–åŒ…)
    - [4.5. å®‰è£…ä¾èµ–é¡¹](#45-å®‰è£…ä¾èµ–é¡¹)
- [5. åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®](#5-åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®)
- [6. é…ç½®æ–‡ä»¶](#6-é…ç½®æ–‡ä»¶)
- [7. å¼•ç”¨å’Œå¼•ç”³](#7-å¼•ç”¨å’Œå¼•ç”³)

<!-- /TOC -->

## 1. ç®€ä»‹

**Yarn æ˜¯å¿«é€Ÿã€å¯é ã€å®‰å…¨çš„ js åŒ…ç®¡ç†å™¨ã€‚**

- **å¿«é€Ÿ** - Yarn ä¼šç¼“å­˜å®ƒä¸‹è½½çš„æ¯ä¸ªåŒ…ï¼Œæ‰€ä»¥æ— éœ€é‡å¤ä¸‹è½½ã€‚å®ƒè¿˜èƒ½å¹¶è¡ŒåŒ–æ“ä½œä»¥æœ€å¤§åŒ–èµ„æºåˆ©ç”¨ç‡ï¼Œå®‰è£…é€Ÿåº¦ä¹‹å¿«å‰æ‰€æœªæœ‰ã€‚
- **å®‰å…¨** - Yarn ä¼šåœ¨æ¯ä¸ªå®‰è£…åŒ…è¢«æ‰§è¡Œå‰æ ¡éªŒå…¶å®Œæ•´æ€§ã€‚
- **å¯é ** - Yarn ä½¿ç”¨æ ¼å¼è¯¦å°½è€Œåˆç®€æ´çš„ lockfile æ–‡ä»¶å’Œç¡®å®šæ€§ç®—æ³•æ¥å®‰è£…ä¾èµ–ï¼Œèƒ½å¤Ÿä¿è¯åœ¨ä¸€ä¸ªç³»ç»Ÿä¸Šçš„è¿è¡Œçš„å®‰è£…è¿‡ç¨‹ä¹Ÿä¼šä»¥åŒæ ·çš„æ–¹å¼è¿è¡Œåœ¨å…¶ä»–ç³»ç»Ÿä¸Šã€‚

## 2. å®‰è£…

å…ˆå†³æ¡ä»¶ï¼šå·²å®‰è£… Nodejsã€‚

æ‰§è¡Œå‘½ä»¤ï¼š`npm i -g yarn`

è™½ç„¶è¿˜æœ‰å…¶ä»–å®‰è£…æ–¹å¼ï¼Œä½†å¹¶ä¸æ¨èã€‚

## 3. Yarn å·¥ä½œæµ

Yarn å·¥ä½œæµï¼š

1. åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®
2. å¢åŠ ï¼æ›´æ–°ï¼åˆ é™¤ä¾èµ–
3. å®‰è£…ï¼é‡è£…ä½ çš„ä¾èµ–
4. å¼•å…¥ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼ˆä¾‹å¦‚ gitï¼‰
5. æŒç»­é›†æˆ

## 4. Yarn å¸¸ç”¨å‘½ä»¤

**æ¯ä¸ªå‘½ä»¤éƒ½ä¼šæ›´æ–° `package.json` å’Œ `yarn.lock` æ–‡ä»¶ã€‚**

### 4.1. åˆå§‹åŒ–æ–°é¡¹ç›®

```sh
yarn init
```

### 4.2. æ·»åŠ ä¾èµ–åŒ…

åœ¨ä½¿ç”¨ä¸€ä¸ªåŒ…ä¹‹å‰ï¼Œä½ éœ€è¦æ‰§è¡Œä»¥ä¸‹å‘½ä»¤å°†å…¶åŠ å…¥ä¾èµ–é¡¹åˆ—è¡¨ï¼š

```sh
yarn add [package]
```

`[package]`ä¼šè¢«åŠ å…¥åˆ°`package.json`æ–‡ä»¶ä¸­çš„ä¾èµ–åˆ—è¡¨ï¼ŒåŒæ—¶`yarn.lock`ä¹Ÿä¼šè¢«æ›´æ–°ã€‚

```diff
  {
    "name": "my-package",
    "dependencies": {
+     "package-1": "^1.0.0"
    }
  }
```

ä½ å¯ä»¥ç”¨ä»¥ä¸‹å‚æ•°æ·»åŠ å…¶å®ƒ[ç±»å‹](https://yarnpkg.com/zh-Hans/docs/dependency-types)çš„ä¾èµ–ï¼š

- `yarn add --dev` æ·»åŠ åˆ° `devDependencies`
- `yarn add --peer` æ·»åŠ åˆ° `peerDependencies`
- `yarn add --optional` æ·»åŠ åˆ° `optionalDependencies`

é€šè¿‡æŒ‡å®š[ä¾èµ–ç‰ˆæœ¬](https://yarnpkg.com/zh-Hans/docs/dependency-versions)å’Œ[æ ‡ç­¾](https://yarnpkg.com/zh-Hans/docs/cli/tag)ï¼Œä½ å¯ä»¥å®‰è£…ä¸€ä¸ªç‰¹å®šç‰ˆæœ¬çš„åŒ…ï¼š

```sh
yarn add [package]@[version]
yarn add [package]@[tag]
```

`[version]` æˆ– `[tag]` ä¼šè¢«æ·»åŠ åˆ° `package.json`ï¼Œå¹¶åœ¨å®‰è£…ä¾èµ–æ—¶è¢«è§£æã€‚

ä¾‹å¦‚ï¼š

```sh
yarn add package-1@1.2.3
yarn add package-2@^1.0.0
yarn add package-3@beta
{
  "dependencies": {
    "package-1": "1.2.3",
    "package-2": "^1.0.0",
    "package-3": "beta"
  }
}
```

**å°†ä¾èµ–é¡¹æ·»åŠ åˆ°ä¸åŒä¾èµ–é¡¹ç±»åˆ«**

åˆ†åˆ«æ·»åŠ åˆ° `devDependencies`ã€`peerDependencies` å’Œ `optionalDependencies`ï¼š

```sh
yarn add [package] --dev
yarn add [package] --peer
yarn add [package] --optional
```

### 4.3. æ›´æ–°ä¾èµ–åŒ…

```sh
yarn upgrade [package]
yarn upgrade [package]@[version]
yarn upgrade [package]@[tag]
```

è¿™ä¼šæ›´æ–°`package.json`å’Œ`yarn.lock` æ–‡ä»¶ã€‚

```diff
  {
    "name": "my-package",
    "dependencies": {
-     "package-1": "^1.0.0"
+     "package-1": "^2.0.0"
    }
  }
```

### 4.4. åˆ é™¤ä¾èµ–åŒ…

```
yarn remove [package]
```

è¿™ä¼šæ›´æ–°`package.json`å’Œ`yarn.lock` æ–‡ä»¶ã€‚

### 4.5. å®‰è£…ä¾èµ–é¡¹

`yarn install` æ˜¯ç”¨äºå®‰è£…ä¸€ä¸ªé¡¹ç›®çš„æ‰€æœ‰ä¾èµ–ã€‚ Yarn ä¼šä» `package.json` ä¸­è¯»å–ä¾èµ–ï¼Œå¹¶å°†ä¾èµ–ä¿¡æ¯å­˜å‚¨åˆ° `yarn.lock` ä¸­ã€‚

å¦‚æœä½ æ­£åœ¨å¼€å‘ä¸€ä¸ªåŒ…ï¼Œé€šå¸¸ä½ ä¼šåœ¨ä»¥ä¸‹æƒ…å†µä¹‹åè¿›è¡Œä¾èµ–å®‰è£…ï¼š

- ä½ åˆšæ£€å‡ºéœ€è¦è¿™äº›ä¾èµ–é¡¹çš„é¡¹ç›®ä»£ç ã€‚
- é¡¹ç›®çš„å¦ä¸€ä¸ªå¼€å‘è€…æ·»åŠ äº†æ–°çš„ä¾èµ–ï¼Œä½ éœ€è¦ç”¨åˆ°ã€‚

æœ‰å¾ˆå¤šå‚æ•°å¯ä»¥æ§åˆ¶ä¾èµ–å®‰è£…çš„è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ï¼š

- å®‰è£…æ‰€æœ‰ä¾èµ– - yarn æˆ– yarn install
- å®‰è£…ä¸€ä¸ªåŒ…çš„å•ä¸€ç‰ˆæœ¬ - yarn install --flat
- å¼ºåˆ¶é‡æ–°ä¸‹è½½æ‰€æœ‰åŒ… - yarn install --force
- åªå®‰è£…ç”Ÿäº§ç¯å¢ƒä¾èµ– - yarn install --production

> å‚è€ƒï¼š`yarn install` çš„ [å®Œæ•´å‚æ•°åˆ—è¡¨](https://yarnpkg.com/zh-Hans/docs/cli/install)ã€‚

## 5. åˆ›å»ºä¸€ä¸ªæ–°é¡¹ç›®

ä¸è®ºæ˜¯å·²ç»æœ‰äº†ç°æˆçš„ä»£ç ä»“åº“ï¼ˆç›®å½•ï¼‰ï¼Œè¿˜æ˜¯æ­£ç€æ‰‹å¯åŠ¨ä¸€ä¸ªå…¨æ–°é¡¹ç›®ï¼Œä½ éƒ½å¯ä»¥ä½¿ç”¨åŒæ ·çš„æ–¹æ³•å¼•å…¥ Yarnã€‚

åœ¨å‘½ä»¤è¡Œç»ˆç«¯é‡Œï¼Œè·³è½¬åˆ°å‡†å¤‡å¼•å…¥ Yarn çš„ç›®å½•ï¼ˆé€šå¸¸æ˜¯ä¸€ä¸ªé¡¹ç›®çš„æ ¹ç›®å½•ï¼‰ï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š

```sh
yarn init
```

è¿™å°†æ‰“å¼€ä¸€ä¸ªç”¨äºåˆ›å»º Yarn é¡¹ç›®çš„äº¤äº’å¼è¡¨å•ï¼Œå…¶ä¸­åŒ…å«ä»¥ä¸‹é—®é¢˜ï¼š

```
name (your-project):
version (1.0.0):
description:
entry point (index.js):
git repository:
author:
license (MIT):
```

ä½ æ—¢å¯ä»¥å›ç­”è¿™äº›é—®é¢˜ï¼Œä¹Ÿå¯ä»¥ç›´æ¥æ•²å›è½¦é”®ï¼ˆenter/returnï¼‰ä½¿ç”¨é»˜è®¤é…ç½®æˆ–è€…ç•™ç©ºã€‚

## 6. é…ç½®æ–‡ä»¶

ä¸ºäº†åˆ«äººèƒ½ä½¿ç”¨ä½ çš„åŒ…ï¼Œä»¥ä¸‹æ–‡ä»¶å¿…é¡»è¢«æäº¤è¿›ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼š

- `package.json` - åŒ…å«åŒ…çš„æ‰€æœ‰ä¾èµ–ä¿¡æ¯ï¼›
- `yarn.lock` - è®°å½•æ¯ä¸€ä¸ªä¾èµ–é¡¹çš„ç¡®åˆ‡ç‰ˆæœ¬ä¿¡æ¯ï¼›
- åŒ…å®ç°åŠŸèƒ½çš„å®é™…é¡¹ç›®ä»£ç ã€‚

> è¯·å‚é˜…[Yarn Example Package](https://github.com/yarnpkg/example-yarn-package)é¡¹ç›®ï¼ŒæŸ¥çœ‹ä¸€ä¸ªå¯ç”¨çš„ Yarn åŒ…æ‰€éœ€çš„æœ€å°‘æ–‡ä»¶é…ç½®ã€‚

ç°åœ¨åº”è¯¥åˆ›å»ºäº†ä¸€ä¸ªå’Œä¸‹é¢æ–‡ä»¶å†…å®¹ç±»ä¼¼çš„ `package.json`ï¼š

```json
{
  "name": "my-new-project",
  "version": "1.0.0",
  "description": "My New Project description.",
  "main": "index.js",
  "repository": {
    "url": "https://example.com/your-username/my-new-project",
    "type": "git"
  },
  "author": "Your Name <you@example.com>",
  "license": "MIT"
}
```

æ‰§è¡Œ`yarn init`ä¹‹åï¼Œé™¤äº†ä»¥ä¸Šæ–‡ä»¶è¢«åˆ›å»ºä¹‹å¤–ï¼Œæ²¡æœ‰ä»»ä½•å‰¯ä½œç”¨ã€‚ä½ å¯ä»¥éšæ„ç¼–è¾‘æ­¤æ–‡ä»¶ã€‚

`package.json`æ–‡ä»¶é‡Œå­˜å‚¨äº†é¡¹ç›®çš„æœ‰å…³ä¿¡æ¯ã€‚ åŒ…æ‹¬é¡¹ç›®åç§°ã€ç»´æŠ¤è€…ä¿¡æ¯ã€ä»£ç æ‰˜ç®¡åœ°å€ï¼Œä»¥åŠæœ€é‡è¦çš„ï¼šé¡¹ç›®ä¾èµ–ã€‚

## 7. å¼•ç”¨å’Œå¼•ç”³

> ğŸ‘‰ æ¬¢è¿é˜…è¯» [æˆ‘çš„å‰ç«¯æŠ€æœ¯æ•™ç¨‹ç³»åˆ—ï¼šfrontend-tutorial](https://github.com/dunwu/frontend-tutorial)

- [Yarn Github](https://github.com/yarnpkg/yarn)
- [Yarn å®˜æ–¹æ–‡æ¡£](https://yarnpkg.com/zh-Hans/)
